(function(){"use strict";let c=null,o=[],t=-1,e=[];const n=document.getElementById("command-palette"),r=document.getElementById("command-palette-input"),s=document.getElementById("command-palette-results");async function f(){if(o.length>0)return;try{const e=await fetch("/index.json");o=await e.json(),c=new Fuse(o,{keys:[{name:"title",weight:2},{name:"summary",weight:1},{name:"tags",weight:1.5},{name:"stack",weight:1.5}],threshold:.3,ignoreLocation:!0,includeScore:!0,includeMatches:!0})}catch(e){console.error("Failed to load search index:",e)}}function p(e){const t=e.match(/^\/(\S+)\s*(.*)?$/);return t?{tag:t[1].toLowerCase(),search:(t[2]||"").trim()}:{tag:null,search:e.trim()}}function d(e,t){return e.filter(e=>{const n=(e.tags||[]).map(e=>e.toLowerCase()),s=(e.stack||[]).map(e=>e.toLowerCase());return n.includes(t)||s.includes(t)})}function g(n){if(!c||!n){e=[],i();return}const{tag:s,search:a}=p(n);if(s&&!a)e=d(o,s).map(e=>({item:e}));else if(s&&a){const t=d(o,s),n=new Fuse(t,{keys:[{name:"title",weight:2},{name:"summary",weight:1}],threshold:.3,ignoreLocation:!0,includeScore:!0});e=n.search(a)}else e=c.search(a);t=e.length>0?0:-1,i()}function i(){if(e.length===0){const e=r.value.trim();s.innerHTML=e?'<div class="command-palette-empty">No results found</div>':'<div class="command-palette-empty">Type to search...</div>';return}s.innerHTML=e.slice(0,10).map((e,n)=>{const s=e.item,o=[...s.tags||[],...s.stack||[]],i=o.length?`<span class="command-palette-tags">${o.map(e=>`<span class="command-palette-tag">${a(e)}</span>`).join("")}</span>`:"";return`
        <a href="${a(s.permalink)}"
           class="command-palette-result ${n===t?"selected":""}"
           data-index="${n}">
          <span class="command-palette-title">${a(s.title)}</span>
          <span class="command-palette-meta">
            <span class="command-palette-section">${a(s.section)}</span>
            ${i}
          </span>
        </a>
      `}).join("")}function a(e){const t=document.createElement("div");return t.textContent=e||"",t.innerHTML}function u(){f(),n.classList.add("open"),n.setAttribute("aria-hidden","false"),r.focus(),document.body.style.overflow="hidden"}function l(){n.classList.remove("open"),n.setAttribute("aria-hidden","true"),r.value="",e=[],t=-1,i(),document.body.style.overflow=""}function h(n){if(e.length===0)return;t=(t+n+e.length)%e.length,i();const o=s.querySelector(".selected");o&&o.scrollIntoView({block:"nearest"})}function m(){t>=0&&e[t]&&(window.location.href=e[t].item.permalink)}document.addEventListener("keydown",e=>{if((e.metaKey||e.ctrlKey)&&e.key==="k"){e.preventDefault(),n.classList.contains("open")?l():u();return}if(e.key==="/"&&!v()){e.preventDefault(),u();return}if(!n.classList.contains("open"))return;switch(e.key){case"Escape":e.preventDefault(),l();break;case"ArrowDown":e.preventDefault(),h(1);break;case"ArrowUp":e.preventDefault(),h(-1);break;case"Enter":e.preventDefault(),m();break}});function v(){const e=document.activeElement;return e&&(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}n.querySelector(".command-palette-backdrop").addEventListener("click",l),r.addEventListener("input",e=>{g(e.target.value)}),s.addEventListener("click",e=>{const n=e.target.closest(".command-palette-result");if(n){const e=parseInt(n.dataset.index,10);isNaN(e)||(t=e,m())}}),s.addEventListener("mousemove",e=>{const n=e.target.closest(".command-palette-result");if(n){const e=parseInt(n.dataset.index,10);!isNaN(e)&&e!==t&&(t=e,i())}})})()