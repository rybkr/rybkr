{{ define "main" }}
<main>
    <h1>Projects</h1>
    <p class="project-intro">A selection of work and research.</p>

    <input
        id="project-search"
        class="project-search"
        type="search"
        placeholder="Search projectsâ€¦"
        aria-label="Search projects"
    />

    <div id="project-filters" class="filter-bar">
        {{ $tags := slice }} {{ range .Pages }} {{ range .Params.tags }} {{
        $tags = $tags | append . }} {{ end }} {{ end }} {{ $unique := $tags |
        uniq | sort }} {{ range $unique }}
        <button class="filter-pill" data-tag="{{ . }}">{{ . }}</button>
        {{ end }}
    </div>

    <section id="projects">
        {{ range .Pages.ByDate.Reverse }}
        <article class="project-card" data-tags="{{ .Params.tags | jsonify }}">
            <div class="card-left">
                <h2><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>

                {{ with .Params.subtitle }}
                <p class="project-card-subtitle">{{ . }}</p>
                {{ end }}

                <div class="tag-row">
                    {{ range .Params.tags }}
                    <span class="tag-pill">{{ . }}</span>
                    {{ end }}
                </div>
            </div>

            <div class="card-middle">
                {{ with .Params.summary }} {{ if ne . "" }}
                <p>{{ . }}</p>
                {{ end }} {{ end }}

                <div class="stack-row">
                    {{ range .Params.stack }}
                    <span class="stack-pill">{{ . }}</span>
                    {{ end }}
                </div>
            </div>

            <div class="card-right">
                {{ with .Params.thumbnail }}
                <img
                    class="project-thumb"
                    src="{{ . }}"
                    alt="{{ $.Title }} thumbnail"
                />
                {{ end }}
            </div>
        </article>

        {{ end }}
    </section>
</main>
<script src="/js/projects-filter.js"></script>
{{ end }}
